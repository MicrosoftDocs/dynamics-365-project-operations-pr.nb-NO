---
title: Konfigurere automatisk fakturaoppretting
description: Dette emnet inneholder informasjon om konfigurasjon av automatisk oppretting av proformafakturaer.
author: rumant
manager: Annbe
ms.date: 04/05/2021
ms.topic: article
ms.service: project-operations
ms.reviewer: kfend
ms.author: rumant
ms.openlocfilehash: 359c5902e0b6a08ab7fc982095062e4d1816db6c
ms.sourcegitcommit: ca0fc078d1a12484eca193fe051b8442c0559db8
ms.translationtype: HT
ms.contentlocale: nb-NO
ms.lasthandoff: 04/07/2021
ms.locfileid: "5866829"
---
# <a name="set-up-automatic-invoice-creation"></a><span data-ttu-id="1777b-103">Konfigurere automatisk fakturaoppretting</span><span class="sxs-lookup"><span data-stu-id="1777b-103">Set up automatic invoice creation</span></span> 
 
<span data-ttu-id="1777b-104">_**Gjelder for:** Lite-distribusjon – avtale til proformafakturering, Project Operations for ressursbaserte/ikke-lagerbaserte scenarioer_</span><span class="sxs-lookup"><span data-stu-id="1777b-104">_**Applies To:** Lite deployment - deal to proforma invoicing, Project Operations for resource/non-stocked based scenarios_</span></span>

<span data-ttu-id="1777b-105">Du kan konfigurere automatisk fakturaoppretting i Dynamics 365 Project Operations.</span><span class="sxs-lookup"><span data-stu-id="1777b-105">You can configure automatic invoice creation in Dynamics 365 Project Operations.</span></span> <span data-ttu-id="1777b-106">Systemet oppretter et utkast til en proformafaktura basert på fakturaplanen for hver prosjektkontrakt og kontraktlinje.</span><span class="sxs-lookup"><span data-stu-id="1777b-106">The system creates a draft proforma invoice based on the invoice schedule for each project contract and contract line.</span></span> <span data-ttu-id="1777b-107">Fakturaplaner konfigureres på kontraktlinjenivå.</span><span class="sxs-lookup"><span data-stu-id="1777b-107">Invoice schedules are configured at the contract line level.</span></span> <span data-ttu-id="1777b-108">Hver linje i en kontrakt kan ha en atskilt faktureraplan, eller den samme fakturaplanen kan tas med i hver linje i kontrakten.</span><span class="sxs-lookup"><span data-stu-id="1777b-108">Each line on a contract can have a distinct invoice schedule, or the same invoice schedule can be included on every line of the contract.</span></span>

<span data-ttu-id="1777b-109">Når du oppretter en faktura, oppretter systemet alltid minst én faktura per prosjektkontrakt.</span><span class="sxs-lookup"><span data-stu-id="1777b-109">When you create an invoice, the system always creates at least one invoice per project contract.</span></span> <span data-ttu-id="1777b-110">I noen tilfeller kan det hende det opprettes flere fakturaer.</span><span class="sxs-lookup"><span data-stu-id="1777b-110">In some cases, there may be multiple invoices created.</span></span> <span data-ttu-id="1777b-111">Hvis for eksempel kontrakten har flere kunder, blir det samme antallet fakturaer opprettet som antall kunder som har fakturerbare transaksjoner å fakturere på den aktuelle prosjektkontrakten.</span><span class="sxs-lookup"><span data-stu-id="1777b-111">For example, if the contract has multiple customers, the same number of invoices will be created as the number of customers that have billable transactions to invoice on that project contract.</span></span>

## <a name="understand-how-transactions-are-included-on-an-invoice"></a><span data-ttu-id="1777b-112">Forstå hvordan transaksjoner tas med på en faktura</span><span class="sxs-lookup"><span data-stu-id="1777b-112">Understand how transactions are included on an invoice</span></span> 

<span data-ttu-id="1777b-113">Noen ganger angir hver prosjektbaserte kontraktlinje en separat fakturaplan.</span><span class="sxs-lookup"><span data-stu-id="1777b-113">Sometimes, each project-based contract line specifies a separate invoice schedule.</span></span> <span data-ttu-id="1777b-114">Implementeringstjenester for Adatum-kontrakten har for eksempel følgende kontraktlinjer:</span><span class="sxs-lookup"><span data-stu-id="1777b-114">For example, implementation services for the Adatum contract have the following contract lines:</span></span>

- <span data-ttu-id="1777b-115">Prototypearbeid som er en fast pris med to manuelt opprettede milepæler.</span><span class="sxs-lookup"><span data-stu-id="1777b-115">Prototype work that is a fixed price with two manually created milestones.</span></span>
- <span data-ttu-id="1777b-116">Implementeringsarbeid som inkluderer tid, og som faktureres annenhver uke på mandager.</span><span class="sxs-lookup"><span data-stu-id="1777b-116">Implementation work that includes Time and will be billed bi-weekly on Mondays.</span></span>
- <span data-ttu-id="1777b-117">Påløpte utgifter som må faktureres månedlig den første mandagen i hver måned.</span><span class="sxs-lookup"><span data-stu-id="1777b-117">Expenses incurred that need to be billed monthly on the first Monday of each month.</span></span>

<span data-ttu-id="1777b-118">Fakturaplaner som er definert for hvert av disse to linjeelementene, ser ut som følgende tabell:</span><span class="sxs-lookup"><span data-stu-id="1777b-118">Invoice schedules defined on each of these two line items look like the following table:</span></span>

| <span data-ttu-id="1777b-119">Kontraktlinje</span><span class="sxs-lookup"><span data-stu-id="1777b-119">Contract line</span></span> | <span data-ttu-id="1777b-120">Dato for fakturakjøring</span><span class="sxs-lookup"><span data-stu-id="1777b-120">Invoice run date</span></span> | <span data-ttu-id="1777b-121">Transaksjonsfrist</span><span class="sxs-lookup"><span data-stu-id="1777b-121">Transaction cut-off date</span></span> | <span data-ttu-id="1777b-122">Milepældato</span><span class="sxs-lookup"><span data-stu-id="1777b-122">Milestone date</span></span> | <span data-ttu-id="1777b-123">Milepælbeløp</span><span class="sxs-lookup"><span data-stu-id="1777b-123">Milestone amount</span></span> |
| --- | --- | --- | --- | --- |
| <span data-ttu-id="1777b-124">Prototypearbeid</span><span class="sxs-lookup"><span data-stu-id="1777b-124">Prototype work</span></span> | <span data-ttu-id="1777b-125">Mandag 5. oktober</span><span class="sxs-lookup"><span data-stu-id="1777b-125">October 5, Monday</span></span> | - | <span data-ttu-id="1777b-126">Mandag 5. oktober</span><span class="sxs-lookup"><span data-stu-id="1777b-126">October 5, Monday</span></span> | <span data-ttu-id="1777b-127">5000 USD</span><span class="sxs-lookup"><span data-stu-id="1777b-127">5000 USD</span></span> |
| - | <span data-ttu-id="1777b-128">Tirsdag 3. november</span><span class="sxs-lookup"><span data-stu-id="1777b-128">November 3, Tuesday</span></span> | - | <span data-ttu-id="1777b-129">Tirsdag 3. november</span><span class="sxs-lookup"><span data-stu-id="1777b-129">November 3, Tuesday</span></span> | <span data-ttu-id="1777b-130">12,000 USD</span><span class="sxs-lookup"><span data-stu-id="1777b-130">12,000 USD</span></span> |
| <span data-ttu-id="1777b-131">Implementeringsarbeid</span><span class="sxs-lookup"><span data-stu-id="1777b-131">Implementation work</span></span> | <span data-ttu-id="1777b-132">Mandag 5. oktober</span><span class="sxs-lookup"><span data-stu-id="1777b-132">October 5, Monday</span></span> | <span data-ttu-id="1777b-133">Søndag 4. oktober</span><span class="sxs-lookup"><span data-stu-id="1777b-133">October 4, Sunday</span></span> | - | - |
| - | <span data-ttu-id="1777b-134">Mandag 19. oktober</span><span class="sxs-lookup"><span data-stu-id="1777b-134">October 19, Monday</span></span> | <span data-ttu-id="1777b-135">Søndag 18. oktober</span><span class="sxs-lookup"><span data-stu-id="1777b-135">October 18, Sunday</span></span> | - | - |
| - | <span data-ttu-id="1777b-136">Mandag 2. november</span><span class="sxs-lookup"><span data-stu-id="1777b-136">November 2, Monday</span></span> | <span data-ttu-id="1777b-137">Søndag 1. november</span><span class="sxs-lookup"><span data-stu-id="1777b-137">November 1, Sunday</span></span> | - | - |
| - | <span data-ttu-id="1777b-138">Mandag 16. november</span><span class="sxs-lookup"><span data-stu-id="1777b-138">November 16, Monday</span></span> | <span data-ttu-id="1777b-139">Søndag 15. november</span><span class="sxs-lookup"><span data-stu-id="1777b-139">November 15, Sunday</span></span> | - | - |
| <span data-ttu-id="1777b-140">Påløpte utgifter</span><span class="sxs-lookup"><span data-stu-id="1777b-140">Expenses incurred</span></span> | <span data-ttu-id="1777b-141">Mandag 5. oktober</span><span class="sxs-lookup"><span data-stu-id="1777b-141">October 5, Monday</span></span> | <span data-ttu-id="1777b-142">Søndag 4. oktober</span><span class="sxs-lookup"><span data-stu-id="1777b-142">October 4, Sunday</span></span> | - | - |
| - | <span data-ttu-id="1777b-143">Mandag 2. november</span><span class="sxs-lookup"><span data-stu-id="1777b-143">November 2, Monday</span></span> | <span data-ttu-id="1777b-144">Søndag 1. november</span><span class="sxs-lookup"><span data-stu-id="1777b-144">November 1, Sunday</span></span> | - | - |

<span data-ttu-id="1777b-145">I dette eksemplet når den automatiske faktureringen kjører på:</span><span class="sxs-lookup"><span data-stu-id="1777b-145">In this example when the automatic invoicing runs on:</span></span>

- <span data-ttu-id="1777b-146">**4. oktober eller en hvilken som helst dato før**: det genereres ingen faktura for denne kontrakten fordi tabellen **Fakturaplan** for hver av disse kontraktlinjene ikke fremhver søndag 4. oktober som en dato for fakturakjøring.</span><span class="sxs-lookup"><span data-stu-id="1777b-146">**October 4 or any date before**: No invoice is generated for this contract because the **Invoice Schedule** table for each of these contract lines doesn't call out October 4, Sunday as an invoice run date.</span></span>
- <span data-ttu-id="1777b-147">**Mandag 5. oktober**: Én faktura genereres for:</span><span class="sxs-lookup"><span data-stu-id="1777b-147">**October 5 Monday**: One invoice is generated for:</span></span>

    - <span data-ttu-id="1777b-148">Prototypearbeid som inkluderer milepælen, hvis den er merket som **klar for fakturering**.</span><span class="sxs-lookup"><span data-stu-id="1777b-148">Prototype work that includes the milestone, if it is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="1777b-149">Implementeringsarbeid som inneholder alle tidstransaksjoner som er opprettet før transaksjonfristen søndag 4. oktober, som er merket som **Klar for fakturering**.</span><span class="sxs-lookup"><span data-stu-id="1777b-149">Implementation work that includes all Time transactions created before the transaction cut-off date of October 4, Sunday, that is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="1777b-150">Påløpt utgift som inneholder alle utgiftstransaksjoner som er opprettet før transaksjonfristen søndag 4. oktober, som er merket som **Klar for fakturering**.</span><span class="sxs-lookup"><span data-stu-id="1777b-150">Expense incurred that includes all Expense transactions created before the transaction cut-off date of October 4, Sunday, that is marked as **Ready to Invoice**.</span></span>
  
- <span data-ttu-id="1777b-151">**6. oktober eller en hvilken som helst dato før 19. oktober**: Det genereres ingen faktura for denne kontrakten fordi tabellen **Fakturaplan** for hver av disse kontraktlinjene ikke fremhver 6. oktober eller en dato før 19. oktober som en dato for fakturakjøring.</span><span class="sxs-lookup"><span data-stu-id="1777b-151">**On October 6 or any date before October 19**: No invoice is generated for this contract since the **Invoice Schedule** table for each of these contract lines does not call out October 6 or any date before October 19 as an invoice run date.</span></span>
- <span data-ttu-id="1777b-152">**Mandag 19. oktober**: Én faktura genereres for implementeringsarbeid som inneholder alle tidstransaksjoner som er opprettet før transaksjonfristen søndag 18. oktober, som er merket som **Klar for fakturering**.</span><span class="sxs-lookup"><span data-stu-id="1777b-152">**October 19, Monday**: One invoice is generated for implementation work that includes all Time transactions created before the transaction cut-off date of October 18, Sunday, that is marked as **Ready to Invoice**.</span></span>
- <span data-ttu-id="1777b-153">**Mandag 2. november**: Én faktura genereres for:</span><span class="sxs-lookup"><span data-stu-id="1777b-153">**November 2 Monday**: One invoice is generated for:</span></span>

    - <span data-ttu-id="1777b-154">Implementeringsarbeid som inneholder alle tidstransaksjoner som er opprettet før transaksjonfristen søndag 1. november, som er merket som **Klar for fakturering**.</span><span class="sxs-lookup"><span data-stu-id="1777b-154">Implementation work that includes all Time transactions created before the transaction cut-off date of November 1, Sunday, that is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="1777b-155">Påløpt utgift som inneholder alle utgiftstransaksjoner som er opprettet før transaksjonfristen søndag 1. november, som er merket som **Klar for fakturering**.</span><span class="sxs-lookup"><span data-stu-id="1777b-155">Expense incurred that includes all Expense transactions created before the transaction cut-off date of November 1, Sunday, that is marked as **Ready to Invoice**.</span></span>

- <span data-ttu-id="1777b-156">**Tirsdag 3. november**: Én faktura genereres for prototypearbeid, som inkluderer milepælen for 12 000 USD, hvis den er merket som **Klar for fakturering**.</span><span class="sxs-lookup"><span data-stu-id="1777b-156">**November 3, Tuesday**: One invoice is generated for prototype work that includes the milestone for 12000 USD, if it is marked as **Ready to Invoice**.</span></span>

## <a name="configure-automatic-invoicing"></a><span data-ttu-id="1777b-157">Konfigurer automatisk fakturering</span><span class="sxs-lookup"><span data-stu-id="1777b-157">Configure automatic invoicing</span></span>

<span data-ttu-id="1777b-158">Fullfør fremgangsmåten nedenfor for å konfigurere en automatisk fakturakjøring.</span><span class="sxs-lookup"><span data-stu-id="1777b-158">Complete the following steps to configure an automated invoice run.</span></span>

1. <span data-ttu-id="1777b-159">I **Project Operations** går du til **Innstillinger** > **Regelmessig fakturaoppsett**.</span><span class="sxs-lookup"><span data-stu-id="1777b-159">In **Project Operations**, go to **Settings** > **Recurring Invoice Setup**.</span></span>
2. <span data-ttu-id="1777b-160">Opprett en satsvis jobb, og gi den navnet **Opprett fakturaer i Project Operations**.</span><span class="sxs-lookup"><span data-stu-id="1777b-160">Create a batch job, and name it **rPoject Operations Create Invoices**.</span></span> <span data-ttu-id="1777b-161">Navnet på den satsvise jobben må inneholde ordene "opprett fakturaer".</span><span class="sxs-lookup"><span data-stu-id="1777b-161">The name of the batch job must include the words, "create invoices".</span></span>
3. <span data-ttu-id="1777b-162">I **Jobbtype**-feltet velger du **Ingen**.</span><span class="sxs-lookup"><span data-stu-id="1777b-162">In the **Job Type** field, select **None**.</span></span> <span data-ttu-id="1777b-163">Som standard er feltene **Daglig intervall** og **Er aktiv** satt til **Ja**.</span><span class="sxs-lookup"><span data-stu-id="1777b-163">By default, the **Frequency Daily** and **Is Active** fields are set to **Yes**.</span></span>
4. <span data-ttu-id="1777b-164">Velg **Kjør arbeidsflyt**.</span><span class="sxs-lookup"><span data-stu-id="1777b-164">Select **Run Workflow**.</span></span> <span data-ttu-id="1777b-165">I dialogboksen **Oppslagsoppføring** vises tre arbeidsflyter:</span><span class="sxs-lookup"><span data-stu-id="1777b-165">In the **Look Up Record** dialog box, you will see three workflows:</span></span>

- <span data-ttu-id="1777b-166">ProcessRunCaller</span><span class="sxs-lookup"><span data-stu-id="1777b-166">ProcessRunCaller</span></span>
- <span data-ttu-id="1777b-167">ProcessRunner</span><span class="sxs-lookup"><span data-stu-id="1777b-167">ProcessRunner</span></span>
- <span data-ttu-id="1777b-168">UpdateRoleUtilization</span><span class="sxs-lookup"><span data-stu-id="1777b-168">UpdateRoleUtilization</span></span>

5. <span data-ttu-id="1777b-169">Velg **ProcessRunCaller**, og velg deretter **Legg til**.</span><span class="sxs-lookup"><span data-stu-id="1777b-169">Select **ProcessRunCaller**, and then select **Add**.</span></span>
6. <span data-ttu-id="1777b-170">Velg **OK** i den neste dialogboksen.</span><span class="sxs-lookup"><span data-stu-id="1777b-170">In the next dialog box, select **OK**.</span></span> <span data-ttu-id="1777b-171">Arbeidsflyten **Hvile** følges av arbeidsflyten **Prosess**.</span><span class="sxs-lookup"><span data-stu-id="1777b-171">A **Sleep** workflow is followed by a **Process** workflow.</span></span> 

> [!NOTE]
> <span data-ttu-id="1777b-172">Du kan også velge **ProcessRunner** i trinn 5.</span><span class="sxs-lookup"><span data-stu-id="1777b-172">You can also select **ProcessRunner** in step 5.</span></span> <span data-ttu-id="1777b-173">Når du deretter velger **OK**, etterfølges en **Prosess**-arbeidsflyt av en **Hvile**-arbeidsflyt.</span><span class="sxs-lookup"><span data-stu-id="1777b-173">Then, when you select **OK**, a **Process** workflow is followed by a **Sleep** workflow.</span></span>

<span data-ttu-id="1777b-174">Arbeidsflytene **ProcessRunCaller** og **ProcessRunner** oppretter fakturaer.</span><span class="sxs-lookup"><span data-stu-id="1777b-174">The **ProcessRunCaller** and **ProcessRunner** workflows create invoices.</span></span> <span data-ttu-id="1777b-175">**ProcessRunCaller** kaller **ProcessRunner**.</span><span class="sxs-lookup"><span data-stu-id="1777b-175">**ProcessRunCaller** calls **ProcessRunner**.</span></span> <span data-ttu-id="1777b-176">**ProcessRunner** er arbeids flyten som faktisk oppretter fakturaene.</span><span class="sxs-lookup"><span data-stu-id="1777b-176">**ProcessRunner** is the workflow that actually creates the invoices.</span></span> <span data-ttu-id="1777b-177">Arbeidsflyten går gjennom alle kontraktslinjene som fakturaer må opprettes for, og den oppretter fakturaer for disse linjene.</span><span class="sxs-lookup"><span data-stu-id="1777b-177">The workflow goes through all the contract lines that invoices must be created for, and creates invoices for those lines.</span></span> <span data-ttu-id="1777b-178">For å finne ut hvilke kontraktslinjer fakturaer må opprettes for, ser jobben på fakturakjøredatoer for kontraktslinjene.</span><span class="sxs-lookup"><span data-stu-id="1777b-178">To determine the contract lines that invoices must be created for, the job looks at invoice run dates for the contract lines.</span></span> <span data-ttu-id="1777b-179">Hvis kontraktslinjer som tilhører én kontrakt, har samme fakturakjøringsdato, kombineres transaksjonene til én faktura som har to fakturalinjer.</span><span class="sxs-lookup"><span data-stu-id="1777b-179">If contract lines that belong to one contract have the same invoice run date, the transactions are combined into one invoice that has two invoice lines.</span></span> <span data-ttu-id="1777b-180">Hvis det ikke finnes transaksjoner for å opprette fakturaer for, hopper jobben over fakturaopprettelsen.</span><span class="sxs-lookup"><span data-stu-id="1777b-180">If there are no transactions to create invoices for, the job skips creating an invoice.</span></span>

<span data-ttu-id="1777b-181">Når **ProcessRunner** har kjørt ferdig, kaller den **ProcessRunCaller**, angir sluttidspunktet og lukkes.</span><span class="sxs-lookup"><span data-stu-id="1777b-181">After **ProcessRunner** has finished running, it calls **ProcessRunCaller**, provides the end time, and is closed.</span></span> <span data-ttu-id="1777b-182">**ProcessRunCaller** starter deretter en tidtaker som kjører i 24 timer, fra det angitte sluttidspunktet.</span><span class="sxs-lookup"><span data-stu-id="1777b-182">**ProcessRunCaller** then starts a timer that runs for 24-hours from the specified end time.</span></span> <span data-ttu-id="1777b-183">Når tidtakeren er ferdig, lukkes **ProcessRunCaller**.</span><span class="sxs-lookup"><span data-stu-id="1777b-183">At the end of the timer, **ProcessRunCaller** is closed.</span></span>

<span data-ttu-id="1777b-184">Den satsvise prosessjobben for oppretting av fakturaer er en gjentakende jobb.</span><span class="sxs-lookup"><span data-stu-id="1777b-184">The batch process job for creating invoices is a recurrent job.</span></span> <span data-ttu-id="1777b-185">Hvis denne satsvise prosessen kjører mange ganger, opprettes flere forekomster av jobben, og dette fører til feil.</span><span class="sxs-lookup"><span data-stu-id="1777b-185">If this batch process is run many times, multiple instances of the job are created and causes errors.</span></span> <span data-ttu-id="1777b-186">Derfor bør du starte den satsvise prosessen bare én gang, og du bør bare starte den på nytt hvis den slutter å kjøre.</span><span class="sxs-lookup"><span data-stu-id="1777b-186">Therefore, you should start the batch process only one time, and then restart only if it stops running.</span></span>

> [!NOTE]
> <span data-ttu-id="1777b-187">Satsvis fakturering i Project Operations kjører bare for prosjektkontraktlinjer som er konfigurert ved hjelp av fakturaplaner.</span><span class="sxs-lookup"><span data-stu-id="1777b-187">Batch invoicing in Project Operations only runs for project contract lines that are configured by invoice schedules.</span></span> <span data-ttu-id="1777b-188">En kontraktlinje med en faktureringsmetode for fast pris må ha milepæler konfigurert.</span><span class="sxs-lookup"><span data-stu-id="1777b-188">A contract line with a fixed price billing method must have milestones configured.</span></span> <span data-ttu-id="1777b-189">Det må konfigureres en datobasert fakturaplan for en prosjektkontraktlinje med en faktureringsmetode for tid og materialer.</span><span class="sxs-lookup"><span data-stu-id="1777b-189">A project contract line with a time and material billing method will need a date-based invoice schedule set up.</span></span>


[!INCLUDE[footer-include](../../includes/footer-banner.md)]
